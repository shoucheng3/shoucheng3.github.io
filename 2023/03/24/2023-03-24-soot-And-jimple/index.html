

<!DOCTYPE html>
<html lang="en" color-mode=light>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>soot-And-jimple - ShouCheng</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="google" content="notranslate" />
  
  <meta name="description" content="参考soot API：https://soot-oss...">
  <meta name="author" content="ShouCheng">
  <link rel="icon" href="/images/icons/favicon-16x16.png" type="image/png" sizes="16x16">
  <link rel="icon" href="/images/icons/favicon-32x32.png" type="image/png" sizes="32x32">
  <link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png" sizes="180x180">
  <meta rel="mask-icon" href="/images/icons/stun-logo.svg" color="#333333">
  
    <meta rel="msapplication-TileImage" content="/images/icons/favicon-144x144.png">
    <meta rel="msapplication-TileColor" content="#000000">
  

  
<link rel="stylesheet" href="/css/style.css">


  
    
<link rel="stylesheet" href="//at.alicdn.com/t/font_1445822_r673sha78lq.css">

  

  
    
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css">

  

  
    
      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/xcode.min.css" name="highlight-style" mode="light">

      
        
        
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/solarized-dark.min.css" name="highlight-style" mode="dark">

      
  

  <script>
    var CONFIG = window.CONFIG || {};
    var ZHAOO = window.ZHAOO || {};
    CONFIG = {
      isHome: false,
      fancybox: true,
      pjax: false,
      lazyload: {
        enable: true,
        only_post: 'false',
        loading: '[object Object]'
      },
      donate: {
        enable: false,
        alipay: '',
        wechat: ''
      },
      galleries: {
        enable: true
      },
      fab: {
        enable: true,
        always_show: false
      },
      carrier: {
        enable: true
      },
      daovoice: {
        enable: true
      },
      preview: {
        background: {
          default: '',
          api: ''
        },
        motto: {
          default: '总之岁月漫长，然而值得等待！',
          typing: true,
          api: 'https://v2.jinrishici.com/one.json',
          data_contents: '["data","content"]'
        },
      },
      qrcode: {
        enable: true,
        type: 'url',
        image: '',
      },
      toc: {
        enable: true
      },
      scrollbar: {
        type: 'default'
      },
      notification: {
        enable: true,
        delay: 4500,
        list: '',
        page_white_list: '',
        page_black_list: ''
      },
      search: {
        enable: true,
        path: '/search.xml'
      }
    }
  </script>

  

  

<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="ShouCheng" type="application/atom+xml">
</head>

<body class="lock-screen">
  <div class="loading"></div>
  
    


  <nav class="navbar">
    <div class="left">
      
        <i class="iconfont iconhome j-navbar-back-home"></i>
      
      
        <i class="iconfont iconqrcode j-navbar-qrcode"></i>
      
      
        <i class="iconfont iconmoono" id="color-toggle" color-toggle="light"></i>
      
      
        <i class="iconfont iconsearch j-navbar-search"></i>
      
    </div>
    <div class="center">soot-And-jimple</div>
    <div class="right">
      <i class="iconfont iconmenu j-navbar-menu"></i>
    </div>
    
      <div id="qrcode-navbar"></div>
    
  </nav>

  
  

<nav class="menu">
  <div class="menu-container">
    <div class="menu-close">
      <i class="iconfont iconbaseline-close-px"></i>
    </div>
    <ul class="menu-content"><li class="menu-item">
        <a href="/ " class="underline "> 首页</a>
      </li><li class="menu-item">
        <a href="/galleries/ " class="underline "> 摄影</a>
      </li><li class="menu-item">
        <a href="/archives/ " class="underline "> 归档</a>
      </li><li class="menu-item">
        <a href="/tags/ " class="underline "> 标签</a>
      </li><li class="menu-item">
        <a href="/categories/ " class="underline "> 分类</a>
      </li><li class="menu-item">
        <a href="/about/ " class="underline "> 关于</a>
      </li></ul>
    
      <div class="menu-copyright"><p>Powered by <a target="_blank" href="https://hexo.io">Hexo</a>  |  Theme - <a target="_blank" href="https://github.com/izhaoo/hexo-theme-zhaoo">zhaoo</a></p></div>
    
  </div>
</nav>
  <main id="main">
  <div class="article-wrap">
    <div class="row container">
      <div class="col-xl-3"></div>
      <div class="col-xl-6"><article class="article">
  <div class="wrap">
    <section class="head">
  <img   class="lazyload" data-original="/images/theme/post-image.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  draggable="false">
  <div class="head-mask">
    <h1 class="head-title">soot-And-jimple</h1>
    <div class="head-info">
      <span class="post-info-item"><i class="iconfont iconcalendar"></i>March 24, 2023</span>
      
      <span class="post-info-item"><i class="iconfont iconfont-size"></i>12596</span>
    </div>
  </div>
</section>
    <section class="main">
      <section class="content">
        <h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p>soot API：<a target="_blank" rel="noopener" href="https://soot-oss.github.io/soot/docs/4.4.1/jdoc/index.html">https://soot-oss.github.io/soot/docs/4.4.1/jdoc/index.html</a></p>
<p>官方文档：<a target="_blank" rel="noopener" href="https://github.com/soot-oss/soot/wiki/Tutorials">https://github.com/soot-oss/soot/wiki/Tutorials</a></p>
<p>PDF：sootsurvivorsguide.pdf</p>
<p>一篇很不错的入门文章：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/558087790">https://zhuanlan.zhihu.com/p/558087790</a></p>
<h3 id="Soot"><a href="#Soot" class="headerlink" title="Soot"></a>Soot</h3><h4 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h4><p>Scene：表示进行分析一个类时产生的完整环境（上下文）。通过它，可以设置应用程序类（提供给 Soot 进行分析的类）、主类（包含主方法的类）和访问关于过程间分析的信息（例如，指针信息和调用图）。</p>
<p>SootClass：表示加载到 Soot 中或使用 Soot 创建的类。</p>
<p>SootMethod：表示类的方法。</p>
<p>SootFiled：表示类的成员字段。</p>
<p>Body：代表一个方法体，有不同的风格，对应于不同的 IR（例如 JimpleBody）。这些数据结构是使用面向对象技术实现的，并且尽可能地设计为易于使用和通用。</p>
<p>Unit： 表示 Soot 中的语句，jimple 使用 Stmt 表示。</p>
<p>Jimple 中间表示的处理方法集合在 soot.jimple、soot.jimple.internal 中，大量优化集合在 soot.jimple.toolkits.* 中，尤其是在 soot.jimple.toolkits.scalar 和 soot.jimple.toolkits.annotation.*</p>
<p>Values：一个数据被表示为一个 Value。包括：局部变量（Local）、常量（在 Jimple 中表示为 Constant）、表达式（在 Jimple 中表示为 Expr）等等。表达式有各种不同的实现，例如 BinopExpr 和 InvokeExpr ，但一般来说可以理解为对一个或多个值执行某些操作并返回另一个值。</p>
<p>Box：在 Soot 中的引用（类似于指针），一般用于修改代码，有以下两种类型。</p>
<ul>
<li>ValueBox：指 Values，每个 unit 中都有使用和定义的 Values 的概念，这对于替换 Units 中使用的或定义的 box 非常有用，例如在执行常量折叠时</li>
<li>UnitBox：指 Units，当一个 unit 可以有多个后继时（例如分支语句），就会使用 UnitBox。</li>
</ul>
<h4 id="Soot-执行阶段"><a href="#Soot-执行阶段" class="headerlink" title="Soot 执行阶段"></a>Soot 执行阶段</h4><p>Soot 中每一个执行的部分被称为 pack，而 Soot 的执行一般分为几个 packs 的阶段。第一步是生成 Jimple 代码以供各种 packs 使用。这是通过解析类、jimple 或 java 文件并将其结果通过 Jimple Body（jb） pack 进行传递。</p>
<p>packs 的命名方案相当简单。第一个字母指定 pack 接受的 IR；s 表示 Shimple，j 表示 Jimple，b 表示 Baf，g 表示 Grimp。第二个字母指定 pack 的角色；b 表示方法主体，t 表示用户定义的转换，o 表示优化，a 表示属性生成(注解)。pack 名称末尾的 p 表示 pack。例如，jap（Jimple 注解包）包含所有程序内分析。</p>
<p>下图是 Inter-procedural analysis（程序间分析） 的执行流程，在 Soot 运行周期中包括三个额外的包：cg（调用图生成），wjtp（整个 Jimple 转换包）和 wjap（整个 Jimple 注解包）。这些包生成的信息可以通过 Scene 提供给 Soot 的其他部分使用。而之后的 jtp、jop、jap 则是给每个 body 使用的，最终的产生的 bb（Baf Body 是 Soot 基于栈的中间表示，用于创建字节码）和 tag</p>
<p><img   class="lazyload" data-original="/2023/03/24/2023-03-24-soot-And-jimple/image-20230325211418466.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">image-20230325211418466</span></p>
<p>我们可以扩展 Soot 的 Main 类以包括我们自己的分析，将一个中间步骤注入到 Soot 中，使得 Soot 可以运行我们自定义的分析并处理传递给它的所有其他选项。过程间（inter-procedural analysis）需要注入到 wjtp 阶段而过程内（intra-procedural analysis）则注入到 jtp 阶段。下图的代码示例展示了如何将一个类 MyAnalysisTagger（执行某些 intra-procedural analysis）的实例注入到 Soot 中。</p>
<p><img   class="lazyload" data-original="/2023/03/24/2023-03-24-soot-And-jimple/image-20230325221540502.png" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" ><span class="image-caption">image-20230325221540502</span></p>
<h4 id="使用Soot创建一个类"><a href="#使用Soot创建一个类" class="headerlink" title="使用Soot创建一个类"></a>使用Soot创建一个类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//加载java.lang.Object类并创建相应的SootClass对象及SootMethods、字段SootFields</span><br><span class="hljs-comment">//如果有使用其他的类文件，需要引入例如标准库的类Scene.v().loadClassAndSupport(&quot;java.lang.System&quot;);</span><br>Scene.v().loadClassAndSupport(<span class="hljs-string">&quot;MyClass&quot;</span>);<br><br><span class="hljs-comment">//为HelloWorld类创建SootClass对象。</span><br>sClass = <span class="hljs-keyword">new</span> SootClass(<span class="hljs-string">&quot;HelloWorld&quot;</span>, Modifier.PUBLIC);<br><br><span class="hljs-comment">//设置父类为java.lang.Object的SootClass对象</span><br>sClass.setSuperclass(Scene.v().getSootClass(<span class="hljs-string">&quot;java.lang.Object&quot;</span>));<br><br><span class="hljs-comment">//把新建的SootClass添加到Scene</span><br>Scene.v().addClass(sClass);<br><br><span class="hljs-comment">//创建一个main方法</span><br>method = <span class="hljs-keyword">new</span> SootMethod(<span class="hljs-string">&quot;main&quot;</span>,                 <br>    Arrays.asList(<span class="hljs-keyword">new</span> Type[] &#123;ArrayType.v(RefType.v(<span class="hljs-string">&quot;java.lang.String&quot;</span>), <span class="hljs-number">1</span>)&#125;),<br>    VoidType.v(), Modifier.PUBLIC | Modifier.STATIC);<br><br><span class="hljs-comment">//将method添加到SootClass中</span><br>sClass.addMethod(method);<br><br><span class="hljs-comment">//为main方法创建一个JimpleBody，并将其设为活跃</span><br>JimpleBody body = Jimple.v().newBody(method);<br>method.setActiveBody(body);<br><br><span class="hljs-comment">//创建locals，并将其放入JimpleBody</span><br>arg = Jimple.v().newLocal(<span class="hljs-string">&quot;l0&quot;</span>, ArrayType.v(RefType.v(<span class="hljs-string">&quot;java.lang.String&quot;</span>), <span class="hljs-number">1</span>));<br>body.getLocals().add(arg);<br><br><span class="hljs-comment">//将第一个参数的值分配给arg</span><br>units.add(Jimple.v().newIdentityStmt(arg, <br>      Jimple.v().newParameterRef(ArrayType.v<br>        (RefType.v(<span class="hljs-string">&quot;java.lang.String&quot;</span>), <span class="hljs-number">1</span>), <span class="hljs-number">0</span>)));<br><br><span class="hljs-comment">//</span><br><span class="hljs-comment">// insert &quot;tmpRef.println(&quot;Hello world!&quot;)&quot;</span><br>&#123;<br>    SootMethod toCall = Scene.v().getMethod<br>      (<span class="hljs-string">&quot;&lt;java.io.PrintStream: void println(java.lang.String)&gt;&quot;</span>);<br>    units.add(Jimple.v().newInvokeStmt<br>        (Jimple.v().newVirtualInvokeExpr<br>           (tmpRef, toCall.makeRef(), StringConstant.v(<span class="hljs-string">&quot;Hello world!&quot;</span>))));<br>&#125;<br><br><span class="hljs-comment">//输出为.class文件</span><br><span class="hljs-keyword">int</span> java_version = Options.v().java_version();<br>String fileName = SourceLocator.v().getFileNameFor(sClass, Options.output_format_class);<br>OutputStream streamOut = <span class="hljs-keyword">new</span> FileOutputStream(fileName);<br>BafASMBackend backend = <span class="hljs-keyword">new</span> BafASMBackend(sClass, java_version);<br>backend.generateClassFile(streamOut);<br>streamOut.close();<br>或者使用<br>String fileName = SourceLocator.v().getFileNameFor(sClass, Options.output_format_class);<br>OutputStream streamOut = <span class="hljs-keyword">new</span> JasminOutputStream(<span class="hljs-keyword">new</span> FileOutputStream(fileName));<br>PrintWriter writerOut = <span class="hljs-keyword">new</span> PrintWriter(<span class="hljs-keyword">new</span> OutputStreamWriter(streamOut));<br>JasminClass jasminClass = <span class="hljs-keyword">new</span> soot.jimple.JasminClass(sClass);<br>jasminClass.print(writerOut);<br>writerOut.flush();<br>streamOut.close();<br><br><span class="hljs-comment">//输出为jimple文件</span><br>String fileName = SourceLocator.v().getFileNameFor(sClass, Options.output_format_jimple);<br>OutputStream streamOut = <span class="hljs-keyword">new</span> FileOutputStream(fileName);<br>PrintWriter writerOut = <span class="hljs-keyword">new</span> PrintWriter(<span class="hljs-keyword">new</span> OutputStreamWriter(streamOut));<br>Printer.v().printTo(sClass, writerOut);<br>writerOut.flush();<br>streamOut.close();<br></code></pre></td></tr></table></figure>

<ul>
<li>SootClass 对应着一个对象。</li>
<li>SootMethod 只能有一个活动的 Body，可通过 SootMethod.getActiveBody() 获取。</li>
<li>Body有三个重要的功能：Locals、Traps 和 Units。<ul>
<li>Locals 是主体中的局部变量。</li>
<li>Traps 是哪些单元捕获的哪些异常。</li>
<li>Units 是语句本身。</li>
</ul>
</li>
</ul>
<h4 id="Soot配置与使用"><a href="#Soot配置与使用" class="headerlink" title="Soot配置与使用"></a>Soot配置与使用</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java">G.reset();<span class="hljs-comment">//初始化soot</span><br>Options.v().set_src_prec(Options.src_prec_class);<span class="hljs-comment">//设置处理文件的类型,默认的是class文件</span><br>Options.v().set_process_dir(Collections.singletonList(processDir))<span class="hljs-comment">//处理路径</span><br>Options.v().set_whole_program(<span class="hljs-keyword">true</span>);<span class="hljs-comment">//开启全局模式</span><br>Options.v().set_allow_phantom_refs(<span class="hljs-keyword">true</span>);<span class="hljs-comment">//开启虚引用</span><br>Options.v().set_prepend_classpath(<span class="hljs-keyword">true</span>);<span class="hljs-comment">//允许soot使用JVM的classpath</span><br>Options.v().set_output_format(Options.output_format_jimple);<span class="hljs-comment">//文件输出格式设置为jimple</span><br>Scene.v().loadNecessaryClasses();<span class="hljs-comment">//加载所有需要的类</span><br>PackManager.v().runPacks();<span class="hljs-comment">//运行soot中所有的分析包</span><br>PackManager.v().writeOutput();<span class="hljs-comment">//输出结果</span><br><br>G.reset();<br>Options.v().set_src_prec(Options.src_prec_class);<br>Options.v().set_process_dir(Collections.singletonList(processDir))<br>Options.v().set_whole_program(<span class="hljs-keyword">true</span>);<br>Options.v().set_allow_phantom_refs(<span class="hljs-keyword">true</span>);<br>Options.v().set_prepend_classpath(<span class="hljs-keyword">true</span>);<br>Options.v().set_output_format(Options.output_format_jimple);<br>Scene.v().loadNecessaryClasses();<br>PackManager.v().runPacks();<br>PackManager.v().writeOutput();<br></code></pre></td></tr></table></figure>

<p>apk配置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">G.reset();<br>Options.v().set_prepend_classpath(<span class="hljs-keyword">true</span>);<br>Options.v().set_allow_phantom_refs(<span class="hljs-keyword">true</span>);<br>Options.v().set_src_prec(Options.src_prec_apk);<br>Options.v().set_process_dir(Collections.singletonList(apkPath));<br>Options.v().set_android_jars(androidJarPath);<br>Options.v().set_whole_program(<span class="hljs-keyword">true</span>);<br>List&lt;String&gt; excludeList = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>excludeList.add(<span class="hljs-string">&quot;java.*&quot;</span>);<br>excludeList.add(<span class="hljs-string">&quot;javax.*&quot;</span>);<br>Options.v().set_exclude(excludeList);<span class="hljs-comment">//排除不需要分析的类和方法</span><br>Options.v().set_output_format(Options.output_format_jimple);<br>Scene.v().loadNecessaryClasses();<br><span class="hljs-comment">//PackManager.v().runPacks();</span><br></code></pre></td></tr></table></figure>

<p>设置全程序分析，默认情况下是不进行全程序分析的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>  PackManager.v().getPack(<span class="hljs-string">&quot;wjtp&quot;</span>).add(<br>      <span class="hljs-keyword">new</span> Transform(<span class="hljs-string">&quot;wjtp.myTransform&quot;</span>, <span class="hljs-keyword">new</span> SceneTransformer() &#123;<br>        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">internalTransform</span><span class="hljs-params">(String phaseName,</span></span><br><span class="hljs-params"><span class="hljs-function">            Map options)</span> </span>&#123;<br>          System.err.println(Scene.v().getApplicationClasses());<br>        &#125;<br>      &#125;));<br>  soot.Main.main(args);<br>&#125; <br></code></pre></td></tr></table></figure>

<p>一般使用 jtp、jop、jap 三个 pack 针对每个 body 进行分析。</p>
<ul>
<li>jtp 默认使用，并且是空的，需要我们放入自己的 intra-procedural analyses。</li>
<li>jop 中有 Jimple 优化功能，但在默认情况下是禁用的。</li>
<li>jap 默认启用，但是其中的处理功能会被禁用，当我们把自己的分析放入到 jap 时，会自动开启。</li>
<li>想要往 jtp、jop、jap 中加入 Transform 必须要使用 BodyTransformer。</li>
</ul>
<p>下面是一份 jap 的使用示例。注册了一个新的 BodyTransformer，为每个方法中的每个语句打印出标记</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>  PackManager.v().getPack(<span class="hljs-string">&quot;jap&quot;</span>).add(<br>      <span class="hljs-keyword">new</span> Transform(<span class="hljs-string">&quot;jap.myTransform&quot;</span>, <span class="hljs-keyword">new</span> BodyTransformer() &#123;<br><br>        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">internalTransform</span><span class="hljs-params">(Body body, String phase, Map options)</span> </span>&#123;<br>          <span class="hljs-keyword">for</span> (Unit u : body.getUnits()) &#123;<br>            System.out.println(u.getTags());<br>          &#125;<br>        &#125;<br>      &#125;));<br>  Options.v().set_verbose(<span class="hljs-keyword">true</span>);<br>  PhaseOptions.v().setPhaseOption(<span class="hljs-string">&quot;jap.npc&quot;</span>, <span class="hljs-string">&quot;on&quot;</span>);<br>  soot.Main.main(args);<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="数据流分析"><a href="#数据流分析" class="headerlink" title="数据流分析"></a>数据流分析</h4><ol>
<li>确定分析的性质。是向前还是向后的流分析？是否需要特别考虑分支？</li>
<li>确定预期的近似值。是 may(并集) 分析还是 must(交集) 分析？即确定合并的信息流在通过一个节点时，采取并集还是交集。</li>
<li>执行实际的流分析。实质上为中间表示中的每种语句编写方程——例如，应如何处理赋值语句。</li>
<li>决定入口节点（如果是向后流）和内部节点的初始状态或近似值——通常是空集或全集，具体取决于分析的保守程度。 执行数据流分析需要一些表示数据如何在程序中流动的结构，例如控制流图（cfg）。 Soot 数据流框架通过 soot.toolkits.graph.DirectedGraph 接口进行处理 cfg。</li>
</ol>
<p>Soot 提供了三种数据流分析的实现：</p>
<ul>
<li>ForwardFlowAnalysis 前向分析，从 UnitGraph 的入口语句开始进行向前传播。</li>
<li>BackwardFlowAnalysis 后向分析，从 UnitGraph 的出口节点开始向后传播。</li>
<li>ForwardBranchedFlowAnalysis 前向分支分析，实质上是一种前向分析，但是允许将不同的流集传播到不同的分支中。例如：处理 if(p != null) ，则可以将  p != nll 传播到为 true 的分支中，p == null 传播到为 false 的分支中。</li>
</ul>
<h4 id="继承类"><a href="#继承类" class="headerlink" title="继承类"></a>继承类</h4><p>实现分析，需要继承 ForwardFlowAnalysis（BackwardFlowAnalysis、ForwardBranchedFlowAnalysis ），其有两个参数：</p>
<ul>
<li>N：节点类型。通常是 Unit，但也可以对保存其他类型节点的图进行流分析。</li>
<li>A: 抽象类型。通常使用 sets 或 maps 作为抽象类型，但一般来说，可以使用任何你喜欢的东西。但要注意，抽象类型必须正确地实现 equals(…) 和 hashCode()，这样 Soot 才能确定什么时候达到了固定点。</li>
</ul>
<h5 id="构造函数——真正的实现"><a href="#构造函数——真正的实现" class="headerlink" title="构造函数——真正的实现"></a>构造函数——真正的实现</h5><p>实现一个构造函数，需要以 DirectedGraph&lt;N&gt; 作为参数（其中N是节点类型），并将其传递给父类的构造函数。在构造函数的末尾需要调用 doAnalysis() 方法以执行数据流分析，在调用父类构造函数和 doAnalysis() 方法之间是实现数据流分析的过程。</p>
<p>一些需要实现的抽象方法：</p>
<ul>
<li>newInitialFlow() 返回一个自定义的抽象类型 A 的对象。这个对象被分配为每个语句的初始入集和出集，除了第一个语句的入集（如果实现的是一个向后分析，则为一个退出语句，例如 return 或 throw）</li>
<li>entryInitialFlow() 初始化第一个语句的入集。</li>
<li>copy(A source, A dest) 方法接受两个自定义的抽象类型 A 的参数：源和目标。实现将源复制到目标中。</li>
<li>merge(A in1, A in2, A out) 方法用于在控制流的合并点（例如 if/then/else 语句的末尾）合并流集。接受三个参数，一个来自左分支的出集，一个来自右分支的出集，这将成为合并点之后下一个语句的新合并入集。</li>
<li>flowThrough(A in, N d, A out) 方法接受三个参数，类型为 A 的入集； 要处理的类型为 N 的节点，通常是一个 Unit；类型为 A的出集。</li>
</ul>
<p>最后可以把分析的结果放在 tag 中。</p>
<h3 id="jimple"><a href="#jimple" class="headerlink" title="jimple"></a>jimple</h3><p>Jimple 是 soot 中最主要的中间表示，是一种三地址码（三地址码 Three-Address Code 也可简写为3AC，<strong>要求：指令右侧至多有一个操作符。</strong>）只需要大约15种不同的指令，例如：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm"><span class="hljs-built_in">t2</span> = a + <span class="hljs-keyword">b </span>+ <span class="hljs-number">3</span><br>三地址码则表示为<br><span class="hljs-built_in">t1</span> = a + <span class="hljs-keyword">b</span><br><span class="hljs-keyword"></span><span class="hljs-built_in">t2</span> = <span class="hljs-built_in">t1</span> + <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure>

<p>使用 r0，r1，r2….表示类型对象；i0，i1，i2…..表示基本数据类型变量；带有 $ 表示临时变量，如上面的 t2 的含义；@parameter 表示函数参数。</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">specialinvoke 	用于调用构造方法、父类方法、私有方法<br>virtualinvoke 	用于调用普通的成员方法<br>staticinvoke  	用于调用静态方法<br><span class="hljs-built_in">int</span>erfaceinvoke 相对于virtualinvoke不做优化，需要额外检查接口的实现<br></code></pre></td></tr></table></figure>

<p>其他部分与 smali 挺相像的，并且是很好理解的，直接看是十分容易明白的。直接看下面的例子：</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs arduino"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Loop</span> &#123;</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">String</span>[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> x = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">10</span>;i++)&#123;<br>            x = x+<span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><br>jimple：<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Loop</span> <span class="hljs-title">extends</span> <span class="hljs-title">java</span>.<span class="hljs-title">lang</span>.<span class="hljs-title">Object</span></span><br><span class="hljs-class">&#123;</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> &lt;init&gt;()<br>    &#123;<br>        Loop r0;<br><br>        r0 := @<span class="hljs-keyword">this</span>: Loop;<br><br>        specialinvoke r0.&lt;java.lang.Object: <span class="hljs-keyword">void</span> &lt;init&gt;()&gt;();<br><br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(java.lang.<span class="hljs-keyword">String</span>[])</span></span><br><span class="hljs-function">    </span>&#123;<br>        java.lang.<span class="hljs-keyword">String</span>[] r0;<br>        <span class="hljs-keyword">int</span> i1;<br><br>        r0 := @parameter0: java.lang.<span class="hljs-keyword">String</span>[];<br><br>        i1 = <span class="hljs-number">0</span>;<br><br>     label1:<br>        <span class="hljs-keyword">if</span> i1 &gt;= <span class="hljs-number">10</span> <span class="hljs-keyword">goto</span> label2;<br><br>        i1 = i1 + <span class="hljs-number">1</span>;<br><br>        <span class="hljs-keyword">goto</span> label1;<br><br>     label2:<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>在 jimple 代码中，开头是一个叫 Loop 的类继承了 java.lang.Object 类(默认的所有类的父类），然后是一个初始化的过程，生成默认的构造函数，默认会调用父类的构造函数(即 java.lang.Object )，接下来就是 main 函数，在源代码里 main 函数有一个 String[] args 的参数，这在 jimple 代码中就对应了一个声明的参数 r0，源代码中 for 循环里面的 i 在 jimple 代码中用 i1 指代，label1 里面的内容就是 for 循环的条件内容，只要不满足循环条件，用一个 goto 语句跳转到 label2。这里出现了一个有意思的现象，那就是源代码中 x 值的变化在 jimple 中被“优化”掉了，这是因为 x 是不活跃变量，所以会被优化。</p>
<h4 id="do-while循环"><a href="#do-while循环" class="headerlink" title="do-while循环"></a>do-while循环</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DoWhile</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-keyword">void</span> main(<span class="hljs-keyword">String</span>[] args) &#123;<br>        <span class="hljs-keyword">int</span>[] arr = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">10</span>];<br>        <span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">do</span> &#123;<br>            i = i+<span class="hljs-number">1</span>;<br>        &#125;<span class="hljs-keyword">while</span> (arr[i]&lt;<span class="hljs-number">10</span>);<br>    &#125;<br>&#125;<br><br>jimple：<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DoWhile</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">java</span>.<span class="hljs-title">lang</span>.<span class="hljs-title">Object</span></span><br><span class="hljs-class"></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> &lt;init&gt;()<br>    &#123;<br>        DoWhile r0;<br><br>        r0 := @this: DoWhile;<br><br>        specialinvoke r0.&lt;java.lang.<span class="hljs-keyword">Object</span>: <span class="hljs-keyword">void</span> &lt;init&gt;()&gt;();<br><br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-keyword">void</span> main(java.lang.<span class="hljs-keyword">String</span>[])<br>    &#123;<br>        <span class="hljs-keyword">int</span>[] r0;<br>        <span class="hljs-keyword">int</span> <span class="hljs-variable">$i0</span>, i1;<br>        java.lang.<span class="hljs-keyword">String</span>[] r1;<br><br>        r1 := @parameter0: java.lang.<span class="hljs-keyword">String</span>[];<br><br>        r0 = newarray (<span class="hljs-keyword">int</span>)[<span class="hljs-number">10</span>];<br><br>        i1 = <span class="hljs-number">0</span>;<br><br>     label1:<br>        i1 = i1 + <span class="hljs-number">1</span>;<br><br>        <span class="hljs-variable">$i0</span> = r0[i1];<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-variable">$i0</span> &lt; <span class="hljs-number">10</span> <span class="hljs-keyword">goto</span> label1;<br><br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这里是给数据对象 arr 用 r0 来代替，并对它进行了初始化，接下来还是用 label 表示程序的位置，将每一次循环的条件都能表示出来。可以注意到：Do-While 循环是先进入循环执行对应的语句，再通过 if 语句进行循环的跳转。</p>
<h4 id="方法调用"><a href="#方法调用" class="headerlink" title="方法调用"></a>方法调用</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodCall</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> a = <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">int</span> b = <span class="hljs-number">2</span>;<br>        <span class="hljs-keyword">int</span> c = foo(a,b);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x, <span class="hljs-keyword">int</span> y)</span></span>&#123;<br>        <span class="hljs-keyword">return</span> x + y;<br>    &#125;<br>&#125;<br><br>jimple：<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodCall</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">java</span>.<span class="hljs-title">lang</span>.<span class="hljs-title">Object</span></span><br><span class="hljs-class"></span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> &lt;init&gt;()<br>    &#123;<br>        MethodCall r0;<br><br>        r0 := <span class="hljs-meta">@this</span>: MethodCall;<br><br>        specialinvoke r0.&lt;java.lang.Object: <span class="hljs-keyword">void</span> &lt;init&gt;()&gt;();<br><br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(java.lang.String[])</span></span><br><span class="hljs-function">    </span>&#123;<br>        java.lang.String[] r0;<br><br>        r0 := <span class="hljs-meta">@parameter0</span>: java.lang.String[];<br><br>        staticinvoke &lt;MethodCall: <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>)</span>&gt;<span class="hljs-params">(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)</span></span>;<br><br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">foo</span><span class="hljs-params">(<span class="hljs-keyword">int</span>, <span class="hljs-keyword">int</span>)</span></span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">int</span> i0, i1, $i2;<br><br>        i0 := <span class="hljs-meta">@parameter0</span>: <span class="hljs-keyword">int</span>;<br><br>        i1 := <span class="hljs-meta">@parameter1</span>: <span class="hljs-keyword">int</span>;<br><br>        $i2 = i0 + i1;<br><br>        <span class="hljs-keyword">return</span> $i2;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可以看到我们定义的方法 foo 在源代码和 jimple 源码中差不多，很好理解，就是用了一个中间变量来取得 i0 和 i1 的和，再将这个中间变量 $i2 返回。在 main 函数中使用 staticinvoke 表示静态方法的调用。</p>

      </section>
      <section class="extra">
        
          <ul class="copyright">
  
    <li><strong>本文作者：</strong>ShouCheng</li>
    <li><strong>本文链接：</strong><a href="http://shoucheng3.github.io/2023/03/24/2023-03-24-soot-And-jimple/index.html" title="http:&#x2F;&#x2F;shoucheng3.github.io&#x2F;2023&#x2F;03&#x2F;24&#x2F;2023-03-24-soot-And-jimple&#x2F;index.html">http:&#x2F;&#x2F;shoucheng3.github.io&#x2F;2023&#x2F;03&#x2F;24&#x2F;2023-03-24-soot-And-jimple&#x2F;index.html</a></li>
    <li><strong>版权声明：</strong>本博客所有文章均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" title="BY-NC-SA" target="_blank" rel="noopener">BY-NC-SA</a> 许可协议，转载请注明出处！</li>
  
</ul>
        
        
        
        
  <nav class="nav">
    <a href="/2023/03/28/2023-03-28-FlowDroid%E5%AD%A6%E4%B9%A0/"><i class="iconfont iconleft"></i>FlowDroid学习</a>
    <a href="/2023/03/17/2023-03-17-smali%E8%AF%AD%E6%B3%95/">smali语法<i class="iconfont iconright"></i></a>
  </nav>

      </section>
      
        <section class="comments">
  
    <div class="btn" id="comments-btn">查看评论</div>
  
  
</section>
      
    </section>
  </div>
</article></div>
      <div class="col-xl-3">
        
          
  <aside class="toc-wrap">
    <h3 class="toc-title">文章目录：</h3>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-text">参考</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Soot"><span class="toc-text">Soot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jimple"><span class="toc-text">jimple</span></a></li></ol>
  </aside>

        
      </div>
    </div>
  </div>
</main>
  

<footer class="footer">
  <div class="footer-social"><a 
        href="tencent://message/?Menu=yes&uin=1145020611 "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#12B7F5'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconQQ "></i>
      </a><a 
        href="javascript:; "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#09BB07'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconwechat-fill "></i>
      </a><a 
        href="https://www.instagram.com/izhaoo/ "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#DA2E76'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconinstagram "></i>
      </a><a 
        href="https://shoucheng3.github.io "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color= '#9f7be1'" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  icongithub-fill "></i>
      </a><a 
        href="mailto:1145020611@qq.com "
        target="_blank"
        class="footer-social-item"
        onMouseOver="this.style.color=#FF3B00" 
        onMouseOut="this.style.color='#33333D'">
          <i class="iconfont  iconmail"></i>
      </a></div>
  
    <div class="footer-copyright"><p>Powered by <a target="_blank" href="https://hexo.io">Hexo</a>  |  Theme - <a target="_blank" href="https://github.com/izhaoo/hexo-theme-zhaoo">zhaoo</a></p></div>
  
</footer>
  
      <div class="fab fab-plus">
    <i class="iconfont iconplus"></i>
  </div>
  
    <div class="fab fab-daovoice">
      <i class="iconfont iconcomment"></i>
    </div>
  
  
    <a href="https://support.qq.com/product/325288# app_id" target="_blank">
      <div class="fab fab-tencent-chao">
        <i class="iconfont iconcomment"></i>
      </div>
    </a>
  
  <div class="fab fab-up">
    <i class="iconfont iconcaret-up"></i>
  </div>
  
  
  
    
<script src="/js/color-mode.js"></script>

  
  
    <div class="search">
  <div class="search-container">
    <div class="search-close">
      <i class="iconfont iconbaseline-close-px"></i>
    </div>
    <div class="search-input-wrapper">
      <i class="search-input-icon iconfont iconsearch"></i>
      <input class="search-input" type="search" id="search-input" placeholder="Search..." autofocus autocomplete="off"
        autocorrect="off" autocapitalize="off">
    </div>
    <div class="search-output" id="search-output"></div>
  </div>
</div>
  
</body>

<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>



  
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>




  
<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>






  
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.qrcode/1.0/jquery.qrcode.min.js"></script>




<script src="/js/utils.js"></script>
<script src="/js/script.js"></script>





  

<script>
  (function (i, s, o, g, r, a, m) {
    i["DaoVoiceObject"] = r;
    i[r] = i[r] || function () {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o), m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    a.charset = "utf-8";
    m.parentNode.insertBefore(a, m)
  })(window, document, "script", "https://widget.daovoice.io/widget/0f81ff2f.js", "daovoice")
  daovoice('init', {
    app_id: "3abd194f# app_id"
  }, {
    launcher: {
      disableLauncherIcon: true,
    },
  });
  daovoice('update');
</script>



  <script>
    (function () {
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      } else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>













</html>